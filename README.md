# Flood Risk Prediction tool

Python tool for predicting flood risk for postcodes in the UK.  

## Installation Guide

### Ensure Python is installed:
-  Unix/MacOS: ``python --version`` 
-  Windows: ``py- -version`` 

### Ensure pip is installed:
-  Unix/MacOS: ``python -m pip --version`` 
-  Windows: ``py -m pip --version``

### Ensure git is installed: 
- Unix/MacOS:``git --version``  
- Windows:``git version``  

### Use git to clone this repository: 

``git clone https://github.com/ese-msc-2022/ads-deluge-Clyde.git``    

This will create the ``ads-deluge-Clyde`` directory.   

### Installing requirements:

Requirements can be installed using `pip` or `conda`. 

#### Using `pip`:

Naviate to the ``ads-deluge-Clyde`` directory and run:

``pip install .``  

#### Using `conda`:

Naviate to the ``ads-deluge-Clyde`` directory and run:

 ``conda env create -f environment.yml``

This will create a conda environment called `deluge`. To activate, run:

  ``conda activate deluge``

## User Guide

### Flood risk prediction tool

To use the flood risk prediction model, navigate to the ``ads-deluge-Clyde`` directory and run,

``python flood_risk_model.py``

The tool takes up to 3 optional arguments:

``python flood_risk_model.py -p 'postcodes_file' -l 'sample_labels' -hh 'household_file'``

- `postcodes_file` .csv containing geographic location data for postcodes. 
   See `flood_tool/resources/postcodes_unlabelled.csv` for the required format.
- `sample_labels` .csv containing labelled geographic location data for postcodes. 
   See `flood_tool/resources/postcodes_sampled.csv` for the required format.
- `household_file` .csv containing information on households by postcode. 
   See `flood_tool/resources/households_per_sector.csv` for the required format.
  
If no value supplied, the defaults for each argument are:
- `postcodes_file`: `flood_tool/resources/postcodes_unlabelled.csv`
- `sample_labels`: `flood_tool/resources/postcodes_sampled.csv`
- `household_file`: `flood_tool/resources/households_per_sector.csv`

The risk, label, and median property price predictions generated by the model for the input locations can be found at ``flood_tool/predictions/`` once the run is complete.

### Visualisation tool 

To use the visualisation tool, navigate to the ``ads-deluge-Clyde`` directory and run,

``python visualiser.py``

The visualisations generated are automatically opened in browser.

The tool requires at least one of the following optional arguments:

- `hr`/`heatmap_rain` .csv containing rain level data for geographic locations. 
   See `flood_tool/resources/rrt_vis.csv` for the required format.
- `hr`/`heatmap_river` .csv containing river level data for geographic locations.
   See `flood_tool/resources/rrt_vis.csv` for the required format.
- `ht`/`heatmap_tidal` .csv containing tide level data for geographic locations.
   See `flood_tool/resources/rrt_vis.csv` for the required format.
- `cmrr`/`colormap_rrt` .csv containing rain and river level data for geographic locations.
   See `flood_tool/resources/predictions_vis.csv` for the required format.
- `cmr`/`colormap_r` .csv containing predicted flood risk, risk label, and median property value for geographic locations.
   See `flood_tool/resources/predictions_vis.csv` for the required format.

The visualisations generated can also be found under ``visualisations/`` once the run is complete. 

## Documentation

Documentation was generated using [pdoc](https://github.com/mitmproxy/pdoc), and can be found under `docs/documentation.html` (to be opened in your browser).

## Tests

To check the tool is working correctly, navigate to the ``flood_tool/tests`` directory and run,

``python -m pytest tests.py``

